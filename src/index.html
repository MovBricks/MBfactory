<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>MaibuFactory</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/normalize.css">




</head>

<body>

    <div class="left  pull-left">
        <div class="leftUp">
            <div class="clock">
                <div id="Date"></div>
                <ul>
                    <li id="hours"> </li>
                    <li id="point">:</li>
                    <li id="min"> </li>
                    <li id="point">:</li>
                    <li id="sec"> </li>
                </ul>
            </div>
        </div>
        <div class="real_wathch leftDown">
            <img src="img/real_watch.png" alt="MaibuWatch" width="100%" />
            <canvas id="watchCanvas" width="128" height="128"></canvas>
        </div>
    </div>
    <div class="middle pull-left">
        <div class="watchpainter center">
            <canvas id="painterCanvas" width="128" height="128" style="background-color: #ffff00;width:100%;height:100%;"></canvas>
        </div>
    </div>
    <div class="right pull-left">
        <div class="storehouse rightUp">
            <div id="imgBoxAndboxName">
                <div class="boxNameBar">
                    <div class="boxNameString boxNameStringSelect" onclick="click_switch_img_box_handler(this)">仓库1</div><button onclick="add_img_box_handler()"></button></div>
                <div class="imgContainer">
                    <div class="imgBox show">
                        <div class="previewContainer"></div>
                        <div class="up_img_btn_box"><input type="file" id="upload_img_btn" multiple="multiple" /><button onclick="up_img_btn_face()"><img src="img/img_plus.gif"/></button></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="addLayer rightMiddle">
            <ul id="layerInfoBarList">
                <li class="layerInfoBar">
                    <p>layer1</p><select><option>仓库1</option></select>
                    <div>x:<input type="number" name="x" value="10" /></div>
                    <div>y:<input type="number" name="y" value="10" /></div>
                    <div>width:<input type="number" name="w" value="10" /></div>
                    <div>heigh:<input type="number" name="h" value="10"></div>
                </li>
                <li class="layerInfoBar">
                    <p>layer2</p><select><option>仓库1</option></select>
                    <div>x:<input type="number" name="x" value="10" /></div>
                    <div>y:<input type="number" name="y" value="10" /></div>
                    <div>width:<input type="number" name="w" value="10" /></div>
                    <div>heigh:<input type="number" name="h" value="10"></div>
                </li>
            </ul>
        </div>
        <div class="OS_res rightDown">OS_res</div>
        <div class="sda">asdsad</div>
    </div>

    <script type="text/javascript">
        'use strict';

        var
            watch_canvas = document.getElementById('watchCanvas'),
            ctx = watch_canvas.getContext('2d');
        ctx.clearRect(0, 0, 200, 200); // 擦除(0,0)位置大小为200x200的矩形，擦除的意思是把该区域变为透明
        ctx.fillStyle = '#dddddd'; // 设置颜色
        ctx.fillRect(0, 0, 130, 130); // 把(10,10)位置大小为130x130的矩形涂色
        // 利用Path绘制复杂路径:
        var path = new Path2D();
        path.arc(75, 75, 50, 0, Math.PI * 2, true);
        path.moveTo(110, 75);
        path.arc(75, 75, 35, 0, Math.PI, false);
        path.moveTo(65, 65);
        path.arc(60, 65, 5, 0, Math.PI * 2, true);
        path.moveTo(95, 65);
        path.arc(90, 65, 5, 0, Math.PI * 2, true);
        ctx.strokeStyle = '#000';
        ctx.stroke(path);


        //大画布

        var painter_canvas = document.getElementById('painterCanvas');

        function layerInfoBarCreateHandler(argument) {
            // body... 

        }

        function drawPains() {
            var layerInfoList = document.getElementById('layerInfoBarList');
            for (var oneInfoBar of layerInfoList.children) {

                var x = 10;
                var y = 10;
                var w = 10;
                var h = 10;

                var inputInfoAll = oneInfoBar.getElementsByTagName("input");
                for (var i = 0; i < inputInfoAll.length; i++) {
                    var nameString = inputInfoAll[i].getAttribute("name");
                    var valueInt = parseInt(inputInfoAll[i].getAttribute("value"));
                    if ("x" === nameString) {
                        x = valueInt;
                    } else if ("y" === nameString) {
                        y = valueInt;
                    } else if ("w" === nameString) {
                        w = valueInt;
                    } else if ("h" === nameString) {
                        h = valueInt;
                    }
                }

                //矩形
                var pattLayerNameString = new RegExp("\\d+");
                var layerNameString = pattLayerNameString.exec(oneInfoBar.children[0].innerHTML);

                var layer_1 = painter_canvas.getContext("2d");

                layer_1.beginPath();
                layer_1.lineWidth = "1";
                layer_1.strokeStyle = "red";
                layer_1.rect(x, y, w, h);
                layer_1.stroke();

                layer_1.textAlign = "left";
                layer_1.textBaseline = "hanging";
                layer_1.font = '12px Arial';
                layer_1.fillStyle = '#000';

                layer_1.fillText(layerNameString, x, y + layer_1.lineWidth);
            }

        }

        drawPains();

        var isDragging = false;

        //var previousSelectedCircle;

        function startDragging() {
            isDragging = true;
        }

        function stopDragging() {
            isDragging = false;
        }

        function dragCircle(e) {
            // 判断圆圈是否开始拖拽
            if (isDragging == true) {
                // 判断拖拽对象是否存在
                if (painter_canvas != null) {
                    // 取得鼠标位置
                    var x = e.pageX - painter_canvas.offsetLeft;
                    var y = e.pageY - painter_canvas.offsetTop;

                    // 将圆圈移动到鼠标位置
                    painter_canvas.x = x;
                    painter_canvas.y = y;

                    // 更新画布
                    drawPains();
                }
            }
        }

        painter_canvas.onmouseup = stopDragging;
        painter_canvas.onmouseout = stopDragging;
        painter_canvas.onmousemove = dragCircle;
        painter_canvas.onmousedown = startDragging;
    </script>

    <script type="text/javascript" src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
    <script type="text/javascript" src="js/upload_img.js"></script>
    <!-- <script type="text/javascript" src="js/local_time_clock.js"></script> -->

</body>

</html>